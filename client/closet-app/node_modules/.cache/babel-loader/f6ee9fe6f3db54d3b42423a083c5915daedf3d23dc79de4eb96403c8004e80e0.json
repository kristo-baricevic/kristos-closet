{"ast":null,"code":"var _s = $RefreshSig$();\nimport { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nconst initialState = {\n  isUploadingImage: false,\n  uploadError: null\n};\nexport const uploadImageAndMetaData = _s(createAsyncThunk(\"user/uploadImageAndMetaData\", _s(async (imageFile, dbFormData) => {\n  _s();\n  console.log(\"inside upload action\");\n  const dispatch = useDispatch();\n  dispatch(uploadImageRequest());\n  try {\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      Authorization: `Bearer ${token}`\n    };\n    console.log(\"uploadSlice formData\", dbFormData);\n    const combinedFormData = new FormData();\n    combinedFormData.append(\"imageFile\", imageFile);\n    for (const [key, value] of dbFormData.entries()) {\n      combinedFormData.append(key, value);\n    }\n    await axios.post(\"http://localhost:5000/api/upload\", combinedFormData, {\n      headers\n    });\n    dispatch(uploadImageSuccess());\n  } catch (error) {\n    dispatch(uploadImageFailure(error));\n  }\n}, \"rgTLoBID190wEKCp9+G8W6F7A5M=\", false, function () {\n  return [useDispatch];\n})), \"rgTLoBID190wEKCp9+G8W6F7A5M=\", false, function () {\n  return [useDispatch];\n});\nconst uploadSlice = createSlice({\n  name: \"upload\",\n  initialState,\n  reducers: {\n    uploadImageRequest: state => {\n      state.isUploadingImage = true;\n      state.uploadError = null;\n    },\n    uploadImageSuccess: state => {\n      state.isUploadingImage = false;\n      state.uploadError = null;\n    },\n    uploadImageFailure: (state, action) => {\n      state.isUploadingImage = false;\n      state.uploadError = action.payload;\n    }\n  }\n});\nexport const {\n  uploadImageRequest,\n  uploadImageSuccess,\n  uploadImageFailure\n} = uploadSlice.actions;\nexport const selectIsUploadingImage = state => state.upload.isUploadingImage;\nexport const selectUploadError = state => state.upload.uploadError;\nexport const uploadSliceReducer = uploadSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","useDispatch","axios","initialState","isUploadingImage","uploadError","uploadImageAndMetaData","_s","imageFile","dbFormData","console","log","dispatch","uploadImageRequest","token","localStorage","getItem","headers","Authorization","combinedFormData","FormData","append","key","value","entries","post","uploadImageSuccess","error","uploadImageFailure","uploadSlice","name","reducers","state","action","payload","actions","selectIsUploadingImage","upload","selectUploadError","uploadSliceReducer","reducer"],"sources":["/Users/kristo/kristos-closet/client/closet-app/src/features/uploadSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { useDispatch } from \"react-redux\";\nimport axios from \"axios\";\n\nconst initialState = {\n  isUploadingImage: false,\n  uploadError: null,\n};\n\nexport const uploadImageAndMetaData = createAsyncThunk(\n  \"user/uploadImageAndMetaData\",\n  async ( imageFile, dbFormData ) => {\n    console.log(\"inside upload action\");\n    const dispatch = useDispatch();\n    dispatch(uploadImageRequest());\n    try {\n      const token = localStorage.getItem(\"token\");\n      const headers = {\n        Authorization: `Bearer ${token}`,\n      };\n      \n      console.log(\"uploadSlice formData\", dbFormData);\n\n      const combinedFormData = new FormData();\n      combinedFormData.append(\"imageFile\", imageFile);\n      for (const [key, value] of dbFormData.entries()) {\n        combinedFormData.append(key, value);\n      }\n\n      await axios.post(\"http://localhost:5000/api/upload\", combinedFormData, {\n        headers,\n      });\n\n      dispatch(uploadImageSuccess());\n    } catch (error) {\n      dispatch(uploadImageFailure(error));\n    }\n  }\n);\n\nconst uploadSlice = createSlice({\n  name: \"upload\",\n  initialState,\n  reducers: {\n    uploadImageRequest: (state) => {\n      state.isUploadingImage = true;\n      state.uploadError = null;\n    },\n    uploadImageSuccess: (state) => {\n      state.isUploadingImage = false;\n      state.uploadError = null;\n    },\n    uploadImageFailure: (state, action) => {\n      state.isUploadingImage = false;\n      state.uploadError = action.payload;\n    },\n  },\n});\n\nexport const {\n  uploadImageRequest,\n  uploadImageSuccess,\n  uploadImageFailure,\n} = uploadSlice.actions;\n\nexport const selectIsUploadingImage = (state) => state.upload.isUploadingImage;\nexport const selectUploadError = (state) => state.upload.uploadError;\n\nexport const uploadSliceReducer = uploadSlice.reducer;\n"],"mappings":";AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,SAASC,WAAW,QAAQ,aAAa;AACzC,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,YAAY,GAAG;EACnBC,gBAAgB,EAAE,KAAK;EACvBC,WAAW,EAAE;AACf,CAAC;AAED,OAAO,MAAMC,sBAAsB,GAAAC,EAAA,CAAGP,gBAAgB,CACpD,6BAA6B,EAAAO,EAAA,CAC7B,OAAQC,SAAS,EAAEC,UAAU,KAAM;EAAAF,EAAA;EACjCG,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;EACnC,MAAMC,QAAQ,GAAGX,WAAW,CAAC,CAAC;EAC9BW,QAAQ,CAACC,kBAAkB,CAAC,CAAC,CAAC;EAC9B,IAAI;IACF,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMC,OAAO,GAAG;MACdC,aAAa,EAAG,UAASJ,KAAM;IACjC,CAAC;IAEDJ,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEF,UAAU,CAAC;IAE/C,MAAMU,gBAAgB,GAAG,IAAIC,QAAQ,CAAC,CAAC;IACvCD,gBAAgB,CAACE,MAAM,CAAC,WAAW,EAAEb,SAAS,CAAC;IAC/C,KAAK,MAAM,CAACc,GAAG,EAAEC,KAAK,CAAC,IAAId,UAAU,CAACe,OAAO,CAAC,CAAC,EAAE;MAC/CL,gBAAgB,CAACE,MAAM,CAACC,GAAG,EAAEC,KAAK,CAAC;IACrC;IAEA,MAAMrB,KAAK,CAACuB,IAAI,CAAC,kCAAkC,EAAEN,gBAAgB,EAAE;MACrEF;IACF,CAAC,CAAC;IAEFL,QAAQ,CAACc,kBAAkB,CAAC,CAAC,CAAC;EAChC,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdf,QAAQ,CAACgB,kBAAkB,CAACD,KAAK,CAAC,CAAC;EACrC;AACF,CAAC;EAAA,QAxBkB1B,WAAW;AAAA,EAyBhC,CAAC;EAAA,QAzBoBA,WAAW;AAAA,EAyB/B;AAED,MAAM4B,WAAW,GAAG9B,WAAW,CAAC;EAC9B+B,IAAI,EAAE,QAAQ;EACd3B,YAAY;EACZ4B,QAAQ,EAAE;IACRlB,kBAAkB,EAAGmB,KAAK,IAAK;MAC7BA,KAAK,CAAC5B,gBAAgB,GAAG,IAAI;MAC7B4B,KAAK,CAAC3B,WAAW,GAAG,IAAI;IAC1B,CAAC;IACDqB,kBAAkB,EAAGM,KAAK,IAAK;MAC7BA,KAAK,CAAC5B,gBAAgB,GAAG,KAAK;MAC9B4B,KAAK,CAAC3B,WAAW,GAAG,IAAI;IAC1B,CAAC;IACDuB,kBAAkB,EAAEA,CAACI,KAAK,EAAEC,MAAM,KAAK;MACrCD,KAAK,CAAC5B,gBAAgB,GAAG,KAAK;MAC9B4B,KAAK,CAAC3B,WAAW,GAAG4B,MAAM,CAACC,OAAO;IACpC;EACF;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EACXrB,kBAAkB;EAClBa,kBAAkB;EAClBE;AACF,CAAC,GAAGC,WAAW,CAACM,OAAO;AAEvB,OAAO,MAAMC,sBAAsB,GAAIJ,KAAK,IAAKA,KAAK,CAACK,MAAM,CAACjC,gBAAgB;AAC9E,OAAO,MAAMkC,iBAAiB,GAAIN,KAAK,IAAKA,KAAK,CAACK,MAAM,CAAChC,WAAW;AAEpE,OAAO,MAAMkC,kBAAkB,GAAGV,WAAW,CAACW,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}