{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kristo/kristos-closet/client/closet-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _slicedToArray from\"/Users/kristo/kristos-closet/client/closet-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _createForOfIteratorHelper from\"/Users/kristo/kristos-closet/client/closet-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _asyncToGenerator from\"/Users/kristo/kristos-closet/client/closet-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createSlice,createAsyncThunk}from\"@reduxjs/toolkit\";import axios from\"axios\";var initialState={isUploadingImage:false,uploadError:null};export var uploadImageAndMetaData=createAsyncThunk(\"user/uploadImageAndMetaData\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var imageFile,dbFormData,token,headers,combinedFormData,_iterator,_step,_step$value,key,value;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:imageFile=_ref.imageFile,dbFormData=_ref.dbFormData;console.log(\"inside upload action\");_context.prev=2;token=localStorage.getItem(\"token\");headers={Authorization:\"Bearer \".concat(token)};console.log(\"uploadSlice formData\",dbFormData);combinedFormData=new FormData();combinedFormData.append(\"imageFile\",imageFile);_iterator=_createForOfIteratorHelper(dbFormData.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){_step$value=_slicedToArray(_step.value,2),key=_step$value[0],value=_step$value[1];combinedFormData.append(key,value);}}catch(err){_iterator.e(err);}finally{_iterator.f();}_context.next=12;return axios.post(\"https://closet-app-backend.fly.dev/api/upload\",combinedFormData,{headers:headers});case 12:return _context.abrupt(\"return\",combinedFormData);case 15:_context.prev=15;_context.t0=_context[\"catch\"](2);throw _context.t0;case 18:case\"end\":return _context.stop();}},_callee,null,[[2,15]]);}));return function(_x){return _ref2.apply(this,arguments);};}());var uploadSlice=createSlice({name:\"upload\",initialState:initialState,reducers:{uploadImageRequest:function uploadImageRequest(state){state.isUploadingImage=true;state.uploadError=null;},uploadImageSuccess:function uploadImageSuccess(state){state.isUploadingImage=false;state.uploadError=null;},uploadImageFailure:function uploadImageFailure(state,action){state.isUploadingImage=false;state.uploadError=action.payload;}}});var _uploadSlice$actions=uploadSlice.actions,uploadImageRequest=_uploadSlice$actions.uploadImageRequest,uploadImageSuccess=_uploadSlice$actions.uploadImageSuccess,uploadImageFailure=_uploadSlice$actions.uploadImageFailure;export{uploadImageRequest,uploadImageSuccess,uploadImageFailure};export var selectIsUploadingImage=function selectIsUploadingImage(state){return state.upload.isUploadingImage;};export var selectUploadError=function selectUploadError(state){return state.upload.uploadError;};export var uploadSliceReducer=uploadSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","initialState","isUploadingImage","uploadError","uploadImageAndMetaData","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","imageFile","dbFormData","token","headers","combinedFormData","_iterator","_step","_step$value","key","value","wrap","_callee$","_context","prev","next","console","log","localStorage","getItem","Authorization","concat","FormData","append","_createForOfIteratorHelper","entries","s","n","done","_slicedToArray","err","e","f","post","abrupt","t0","stop","_x","apply","arguments","uploadSlice","name","reducers","uploadImageRequest","state","uploadImageSuccess","uploadImageFailure","action","payload","_uploadSlice$actions","actions","selectIsUploadingImage","upload","selectUploadError","uploadSliceReducer","reducer"],"sources":["/Users/kristo/kristos-closet/client/closet-app/src/features/uploadSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\nconst initialState = {\n  isUploadingImage: false,\n  uploadError: null,\n};\n\nexport const uploadImageAndMetaData = createAsyncThunk(\n  \"user/uploadImageAndMetaData\",\n  async ( {imageFile, dbFormData} ) => {\n    console.log(\"inside upload action\");\n    try {\n\n      const token = localStorage.getItem(\"token\");\n      const headers = {\n        Authorization: `Bearer ${token}`,\n      };\n      \n      console.log(\"uploadSlice formData\", dbFormData);\n\n      const combinedFormData = new FormData();\n\n      combinedFormData.append(\"imageFile\", imageFile);\n\n      for (const [key, value] of dbFormData.entries()) {\n        combinedFormData.append(key, value);\n      }\n\n      await axios.post(\"https://closet-app-backend.fly.dev/api/upload\", combinedFormData, {\n        headers,\n      });\n\n      return combinedFormData;\n    } catch (error) {\n      throw error;\n    }\n  }\n);\n\nconst uploadSlice = createSlice({\n  name: \"upload\",\n  initialState,\n  reducers: {\n    uploadImageRequest: (state) => {\n      state.isUploadingImage = true;\n      state.uploadError = null;\n    },\n    uploadImageSuccess: (state) => {\n      state.isUploadingImage = false;\n      state.uploadError = null;\n    },\n    uploadImageFailure: (state, action) => {\n      state.isUploadingImage = false;\n      state.uploadError = action.payload;\n    },\n  },\n});\n\nexport const {\n  uploadImageRequest,\n  uploadImageSuccess,\n  uploadImageFailure,\n} = uploadSlice.actions;\n\nexport const selectIsUploadingImage = (state) => state.upload.isUploadingImage;\nexport const selectUploadError = (state) => state.upload.uploadError;\n\nexport const uploadSliceReducer = uploadSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}