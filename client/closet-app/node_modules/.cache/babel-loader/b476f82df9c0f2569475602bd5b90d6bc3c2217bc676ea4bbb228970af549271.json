{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nconst initialState = {\n  isUploadingImage: false,\n  uploadError: null\n};\nexport const uploadImageAndMetaData = createAsyncThunk(\"user/uploadImageAndMetaData\", async ({\n  imageFile,\n  dbFormData\n}, dispatch) => {\n  dispatch(uploadImageRequest());\n  try {\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      Authorization: `Bearer ${token}`\n    };\n    console.log(\"uploadSlice formData\", dbFormData);\n    const combinedFormData = new FormData();\n    combinedFormData.append(\"imageFile\", imageFile);\n    for (const [key, value] of dbFormData.entries()) {\n      combinedFormData.append(key, value);\n    }\n    await axios.post(\"http://localhost:5000/api/upload\", combinedFormData, {\n      headers\n    });\n    dispatch(uploadImageSuccess());\n  } catch (error) {\n    dispatch(uploadImageFailure(error));\n  }\n});\nconst uploadSlice = createSlice({\n  name: \"upload\",\n  initialState,\n  reducers: {\n    uploadImageRequest: state => {\n      state.isUploadingImage = true;\n      state.uploadError = null;\n    },\n    uploadImageSuccess: state => {\n      state.isUploadingImage = false;\n      state.uploadError = null;\n    },\n    uploadImageFailure: (state, action) => {\n      state.isUploadingImage = false;\n      state.uploadError = action.payload;\n    }\n  }\n});\nexport const {\n  uploadImageRequest,\n  uploadImageSuccess,\n  uploadImageFailure\n} = uploadSlice.actions;\nexport const selectIsUploadingImage = state => state.upload.isUploadingImage;\nexport const selectUploadError = state => state.upload.uploadError;\nexport const uploadSliceReducer = uploadSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","useDispatch","axios","initialState","isUploadingImage","uploadError","uploadImageAndMetaData","imageFile","dbFormData","dispatch","uploadImageRequest","token","localStorage","getItem","headers","Authorization","console","log","combinedFormData","FormData","append","key","value","entries","post","uploadImageSuccess","error","uploadImageFailure","uploadSlice","name","reducers","state","action","payload","actions","selectIsUploadingImage","upload","selectUploadError","uploadSliceReducer","reducer"],"sources":["/Users/kristo/kristos-closet/client/closet-app/src/features/uploadSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { useDispatch } from \"react-redux\";\nimport axios from \"axios\";\n\nconst initialState = {\n  isUploadingImage: false,\n  uploadError: null,\n};\n\nexport const uploadImageAndMetaData = createAsyncThunk(\n  \"user/uploadImageAndMetaData\",\n  async ({ imageFile, dbFormData }, dispatch ) => {\n    dispatch(uploadImageRequest());\n    try {\n      const token = localStorage.getItem(\"token\");\n      const headers = {\n        Authorization: `Bearer ${token}`,\n      };\n      console.log(\"uploadSlice formData\", dbFormData);\n\n      const combinedFormData = new FormData();\n      combinedFormData.append(\"imageFile\", imageFile);\n      for (const [key, value] of dbFormData.entries()) {\n        combinedFormData.append(key, value);\n      }\n\n      await axios.post(\"http://localhost:5000/api/upload\", combinedFormData, {\n        headers,\n      });\n\n      dispatch(uploadImageSuccess());\n    } catch (error) {\n      dispatch(uploadImageFailure(error));\n    }\n  }\n);\n\nconst uploadSlice = createSlice({\n  name: \"upload\",\n  initialState,\n  reducers: {\n    uploadImageRequest: (state) => {\n      state.isUploadingImage = true;\n      state.uploadError = null;\n    },\n    uploadImageSuccess: (state) => {\n      state.isUploadingImage = false;\n      state.uploadError = null;\n    },\n    uploadImageFailure: (state, action) => {\n      state.isUploadingImage = false;\n      state.uploadError = action.payload;\n    },\n  },\n});\n\nexport const {\n  uploadImageRequest,\n  uploadImageSuccess,\n  uploadImageFailure,\n} = uploadSlice.actions;\n\nexport const selectIsUploadingImage = (state) => state.upload.isUploadingImage;\nexport const selectUploadError = (state) => state.upload.uploadError;\n\nexport const uploadSliceReducer = uploadSlice.reducer;\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,SAASC,WAAW,QAAQ,aAAa;AACzC,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,YAAY,GAAG;EACnBC,gBAAgB,EAAE,KAAK;EACvBC,WAAW,EAAE;AACf,CAAC;AAED,OAAO,MAAMC,sBAAsB,GAAGN,gBAAgB,CACpD,6BAA6B,EAC7B,OAAO;EAAEO,SAAS;EAAEC;AAAW,CAAC,EAAEC,QAAQ,KAAM;EAC9CA,QAAQ,CAACC,kBAAkB,CAAC,CAAC,CAAC;EAC9B,IAAI;IACF,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMC,OAAO,GAAG;MACdC,aAAa,EAAG,UAASJ,KAAM;IACjC,CAAC;IACDK,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAET,UAAU,CAAC;IAE/C,MAAMU,gBAAgB,GAAG,IAAIC,QAAQ,CAAC,CAAC;IACvCD,gBAAgB,CAACE,MAAM,CAAC,WAAW,EAAEb,SAAS,CAAC;IAC/C,KAAK,MAAM,CAACc,GAAG,EAAEC,KAAK,CAAC,IAAId,UAAU,CAACe,OAAO,CAAC,CAAC,EAAE;MAC/CL,gBAAgB,CAACE,MAAM,CAACC,GAAG,EAAEC,KAAK,CAAC;IACrC;IAEA,MAAMpB,KAAK,CAACsB,IAAI,CAAC,kCAAkC,EAAEN,gBAAgB,EAAE;MACrEJ;IACF,CAAC,CAAC;IAEFL,QAAQ,CAACgB,kBAAkB,CAAC,CAAC,CAAC;EAChC,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdjB,QAAQ,CAACkB,kBAAkB,CAACD,KAAK,CAAC,CAAC;EACrC;AACF,CACF,CAAC;AAED,MAAME,WAAW,GAAG7B,WAAW,CAAC;EAC9B8B,IAAI,EAAE,QAAQ;EACd1B,YAAY;EACZ2B,QAAQ,EAAE;IACRpB,kBAAkB,EAAGqB,KAAK,IAAK;MAC7BA,KAAK,CAAC3B,gBAAgB,GAAG,IAAI;MAC7B2B,KAAK,CAAC1B,WAAW,GAAG,IAAI;IAC1B,CAAC;IACDoB,kBAAkB,EAAGM,KAAK,IAAK;MAC7BA,KAAK,CAAC3B,gBAAgB,GAAG,KAAK;MAC9B2B,KAAK,CAAC1B,WAAW,GAAG,IAAI;IAC1B,CAAC;IACDsB,kBAAkB,EAAEA,CAACI,KAAK,EAAEC,MAAM,KAAK;MACrCD,KAAK,CAAC3B,gBAAgB,GAAG,KAAK;MAC9B2B,KAAK,CAAC1B,WAAW,GAAG2B,MAAM,CAACC,OAAO;IACpC;EACF;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EACXvB,kBAAkB;EAClBe,kBAAkB;EAClBE;AACF,CAAC,GAAGC,WAAW,CAACM,OAAO;AAEvB,OAAO,MAAMC,sBAAsB,GAAIJ,KAAK,IAAKA,KAAK,CAACK,MAAM,CAAChC,gBAAgB;AAC9E,OAAO,MAAMiC,iBAAiB,GAAIN,KAAK,IAAKA,KAAK,CAACK,MAAM,CAAC/B,WAAW;AAEpE,OAAO,MAAMiC,kBAAkB,GAAGV,WAAW,CAACW,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}