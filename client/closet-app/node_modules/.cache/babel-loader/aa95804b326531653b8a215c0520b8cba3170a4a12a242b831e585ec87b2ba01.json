{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nconst initialState = {\n  user: null,\n  isAuthenticated: false\n};\n\n// Async thunk action to register user\nexport const registerUser = createAsyncThunk(\"user/registerUser\", async userData => {\n  try {\n    console.log(\"userData about to post\");\n    const response = await axios.post(\"http://localhost:5000/api/register\", userData);\n    console.log(\"userData posted\");\n    if (response.status === 201) {\n      return response.data;\n    }\n  } catch (error) {\n    throw error;\n  }\n});\n\n// Async thunk action to log in user\nexport const loginUser = createAsyncThunk(\"user/loginUser\", async userData => {\n  try {\n    const response = await axios.post(\"http://localhost:5000/api/login\", userData);\n    if (response.status === 200) {\n      const user = response.data.user;\n      const token = response.data.token;\n\n      // Set the token in client storage\n      localStorage.setItem(\"token\", token);\n      return user;\n    }\n  } catch (error) {\n    throw error;\n  }\n});\n\n// Create an async thunk for loginAnonymous\nexport const loginAnonymous = createAsyncThunk(\"user/loginAnonymous\", async () => {\n  try {\n    const response = await axios.post('http://localhost:5000/api/loginAnonymous');\n    const isAuthenticated = response.data.isAuthenticated;\n    const user = response.data.user;\n    const token = response.data.token;\n    localStorage.setItem('token', token);\n    return {\n      isAuthenticated,\n      user\n    };\n  } catch (error) {\n    throw error;\n  }\n});\nexport const userSlice = createSlice({\n  name: \"user\",\n  initialState,\n  reducers: {\n    login: (state, action) => {\n      state.user = action.payload;\n      state.isAuthenticated = true;\n    },\n    logout: state => {\n      state.user = null;\n      state.isAuthenticated = false;\n    },\n    setAuthentication: (state, action) => {\n      state.isAuthenticated = action.payload;\n    },\n    setUser: (state, action) => {\n      state.user = action.payload;\n    },\n    clearAuthentication: state => {\n      state.isAuthenticated = false;\n      state.user = null;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(loginUser.fulfilled, (state, action) => {\n      state.isAuthenticated = true;\n      state.user = action.payload;\n    }).addCase(loginUser.rejected, (state, action) => {\n      // Handle login failure if needed\n    }).addCase(loginAnonymous.fulfilled, (state, action) => {\n      state.isAuthenticated = action.payload.isAuthenticated;\n      state.user = action.payload.user;\n    }).addCase(loginAnonymous.rejected, (state, action) => {\n      // Handle the error case here if needed\n    });\n  }\n});\nexport const {\n  login,\n  logout\n} = userSlice.actions;\nexport const selectUser = state => state.user;\nexport const selectIsAuthenticated = state => state.user.isAuthenticated;\nexport default userSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","initialState","user","isAuthenticated","registerUser","userData","console","log","response","post","status","data","error","loginUser","token","localStorage","setItem","loginAnonymous","userSlice","name","reducers","login","state","action","payload","logout","setAuthentication","setUser","clearAuthentication","extraReducers","builder","addCase","fulfilled","rejected","actions","selectUser","selectIsAuthenticated","reducer"],"sources":["/Users/kristo/kristos-closet/client/closet-app/src/features/userSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\nconst initialState = {\n    user: null,\n    isAuthenticated: false,\n};\n\n\n// Async thunk action to register user\nexport const registerUser = createAsyncThunk(\n    \"user/registerUser\",\n    async (userData) => {\n        try {\n        console.log(\"userData about to post\");\n        const response = await axios.post(\n            \"http://localhost:5000/api/register\",\n            userData\n        );\n        console.log(\"userData posted\");\n\n        if (response.status === 201) {\n            return response.data;\n        }\n        } catch (error) {\n        throw error;\n        }\n    }\n);\n\n// Async thunk action to log in user\nexport const loginUser = createAsyncThunk(\n    \"user/loginUser\",\n    async (userData) => {\n      try {\n        const response = await axios.post(\n          \"http://localhost:5000/api/login\",\n          userData\n        );\n  \n        if (response.status === 200) {\n          const user = response.data.user;\n          const token = response.data.token;\n  \n          // Set the token in client storage\n          localStorage.setItem(\"token\", token);\n  \n          return user;\n        }\n      } catch (error) {\n        throw error;\n      }\n    }\n);\n\n// Create an async thunk for loginAnonymous\nexport const loginAnonymous = createAsyncThunk(\n    \"user/loginAnonymous\",\n    async () => {\n      try {\n        const response = await axios.post('http://localhost:5000/api/loginAnonymous');\n        const isAuthenticated = response.data.isAuthenticated;\n        const user = response.data.user;\n        const token = response.data.token;\n    \n        localStorage.setItem('token', token);\n    \n        return { isAuthenticated, user };\n      } catch (error) {\n        throw error;\n      }\n    }\n  );\n\nexport const userSlice = createSlice({\n    name: \"user\",\n    initialState,\n    reducers: {\n        login: (state, action) => {\n            state.user = action.payload;\n            state.isAuthenticated = true;\n        },\n        logout: (state) => {\n            state.user = null;\n            state.isAuthenticated = false;\n        },\n        setAuthentication: (state, action) => {\n            state.isAuthenticated = action.payload;\n          },\n        setUser: (state, action) => {\n            state.user = action.payload;\n        },\n        clearAuthentication: (state) => {\n            state.isAuthenticated = false;\n            state.user = null;        \n        },\n    },\n    extraReducers: (builder) => {\n        builder\n            .addCase(loginUser.fulfilled, (state, action) => {\n                state.isAuthenticated = true;\n                state.user = action.payload;\n            })\n            .addCase(loginUser.rejected, (state, action) => {\n                // Handle login failure if needed\n            })\n            .addCase(loginAnonymous.fulfilled, (state, action) => {\n                state.isAuthenticated = action.payload.isAuthenticated;\n                state.user = action.payload.user;\n            })\n            .addCase(loginAnonymous.rejected, (state, action) => {\n                // Handle the error case here if needed\n            });\n    },\n});\n\nexport const { login, logout } = userSlice.actions;\n\nexport const selectUser = (state) => state.user;\nexport const selectIsAuthenticated = (state) => state.user.isAuthenticated;\n\nexport default userSlice.reducer;\n\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,YAAY,GAAG;EACjBC,IAAI,EAAE,IAAI;EACVC,eAAe,EAAE;AACrB,CAAC;;AAGD;AACA,OAAO,MAAMC,YAAY,GAAGL,gBAAgB,CACxC,mBAAmB,EACnB,MAAOM,QAAQ,IAAK;EAChB,IAAI;IACJC,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;IACrC,MAAMC,QAAQ,GAAG,MAAMR,KAAK,CAACS,IAAI,CAC7B,oCAAoC,EACpCJ,QACJ,CAAC;IACDC,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;IAE9B,IAAIC,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;MACzB,OAAOF,QAAQ,CAACG,IAAI;IACxB;EACA,CAAC,CAAC,OAAOC,KAAK,EAAE;IAChB,MAAMA,KAAK;EACX;AACJ,CACJ,CAAC;;AAED;AACA,OAAO,MAAMC,SAAS,GAAGd,gBAAgB,CACrC,gBAAgB,EAChB,MAAOM,QAAQ,IAAK;EAClB,IAAI;IACF,MAAMG,QAAQ,GAAG,MAAMR,KAAK,CAACS,IAAI,CAC/B,iCAAiC,EACjCJ,QACF,CAAC;IAED,IAAIG,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;MAC3B,MAAMR,IAAI,GAAGM,QAAQ,CAACG,IAAI,CAACT,IAAI;MAC/B,MAAMY,KAAK,GAAGN,QAAQ,CAACG,IAAI,CAACG,KAAK;;MAEjC;MACAC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;MAEpC,OAAOZ,IAAI;IACb;EACF,CAAC,CAAC,OAAOU,KAAK,EAAE;IACd,MAAMA,KAAK;EACb;AACF,CACJ,CAAC;;AAED;AACA,OAAO,MAAMK,cAAc,GAAGlB,gBAAgB,CAC1C,qBAAqB,EACrB,YAAY;EACV,IAAI;IACF,MAAMS,QAAQ,GAAG,MAAMR,KAAK,CAACS,IAAI,CAAC,0CAA0C,CAAC;IAC7E,MAAMN,eAAe,GAAGK,QAAQ,CAACG,IAAI,CAACR,eAAe;IACrD,MAAMD,IAAI,GAAGM,QAAQ,CAACG,IAAI,CAACT,IAAI;IAC/B,MAAMY,KAAK,GAAGN,QAAQ,CAACG,IAAI,CAACG,KAAK;IAEjCC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;IAEpC,OAAO;MAAEX,eAAe;MAAED;IAAK,CAAC;EAClC,CAAC,CAAC,OAAOU,KAAK,EAAE;IACd,MAAMA,KAAK;EACb;AACF,CACF,CAAC;AAEH,OAAO,MAAMM,SAAS,GAAGpB,WAAW,CAAC;EACjCqB,IAAI,EAAE,MAAM;EACZlB,YAAY;EACZmB,QAAQ,EAAE;IACNC,KAAK,EAAEA,CAACC,KAAK,EAAEC,MAAM,KAAK;MACtBD,KAAK,CAACpB,IAAI,GAAGqB,MAAM,CAACC,OAAO;MAC3BF,KAAK,CAACnB,eAAe,GAAG,IAAI;IAChC,CAAC;IACDsB,MAAM,EAAGH,KAAK,IAAK;MACfA,KAAK,CAACpB,IAAI,GAAG,IAAI;MACjBoB,KAAK,CAACnB,eAAe,GAAG,KAAK;IACjC,CAAC;IACDuB,iBAAiB,EAAEA,CAACJ,KAAK,EAAEC,MAAM,KAAK;MAClCD,KAAK,CAACnB,eAAe,GAAGoB,MAAM,CAACC,OAAO;IACxC,CAAC;IACHG,OAAO,EAAEA,CAACL,KAAK,EAAEC,MAAM,KAAK;MACxBD,KAAK,CAACpB,IAAI,GAAGqB,MAAM,CAACC,OAAO;IAC/B,CAAC;IACDI,mBAAmB,EAAGN,KAAK,IAAK;MAC5BA,KAAK,CAACnB,eAAe,GAAG,KAAK;MAC7BmB,KAAK,CAACpB,IAAI,GAAG,IAAI;IACrB;EACJ,CAAC;EACD2B,aAAa,EAAGC,OAAO,IAAK;IACxBA,OAAO,CACFC,OAAO,CAAClB,SAAS,CAACmB,SAAS,EAAE,CAACV,KAAK,EAAEC,MAAM,KAAK;MAC7CD,KAAK,CAACnB,eAAe,GAAG,IAAI;MAC5BmB,KAAK,CAACpB,IAAI,GAAGqB,MAAM,CAACC,OAAO;IAC/B,CAAC,CAAC,CACDO,OAAO,CAAClB,SAAS,CAACoB,QAAQ,EAAE,CAACX,KAAK,EAAEC,MAAM,KAAK;MAC5C;IAAA,CACH,CAAC,CACDQ,OAAO,CAACd,cAAc,CAACe,SAAS,EAAE,CAACV,KAAK,EAAEC,MAAM,KAAK;MAClDD,KAAK,CAACnB,eAAe,GAAGoB,MAAM,CAACC,OAAO,CAACrB,eAAe;MACtDmB,KAAK,CAACpB,IAAI,GAAGqB,MAAM,CAACC,OAAO,CAACtB,IAAI;IACpC,CAAC,CAAC,CACD6B,OAAO,CAACd,cAAc,CAACgB,QAAQ,EAAE,CAACX,KAAK,EAAEC,MAAM,KAAK;MACjD;IAAA,CACH,CAAC;EACV;AACJ,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEF,KAAK;EAAEI;AAAO,CAAC,GAAGP,SAAS,CAACgB,OAAO;AAElD,OAAO,MAAMC,UAAU,GAAIb,KAAK,IAAKA,KAAK,CAACpB,IAAI;AAC/C,OAAO,MAAMkC,qBAAqB,GAAId,KAAK,IAAKA,KAAK,CAACpB,IAAI,CAACC,eAAe;AAE1E,eAAee,SAAS,CAACmB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}