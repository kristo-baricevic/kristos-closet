{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kristo/kristos-closet/client/closet-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/kristo/kristos-closet/client/closet-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createSlice,createAsyncThunk}from\"@reduxjs/toolkit\";import axios from\"axios\";var initialState={user:null,isAuthenticated:false};// Async thunk action to register user\nexport var registerUser=createAsyncThunk(\"user/registerUser\",/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(userData){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;console.log(\"userData about to post\");_context.next=4;return axios.post(\"https://closet-app-backend.fly.dev/api/register\",userData);case 4:response=_context.sent;console.log(\"userData posted\");if(!(response.status===201)){_context.next=8;break;}return _context.abrupt(\"return\",response.data);case 8:_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);throw _context.t0;case 13:case\"end\":return _context.stop();}},_callee,null,[[0,10]]);}));return function(_x){return _ref.apply(this,arguments);};}());// Async thunk action to log in user\nexport var loginUser=createAsyncThunk(\"user/loginUser\",/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(userData){var response,user,token;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post(\"https://closet-app-backend.fly.dev/api/login\",userData);case 3:response=_context2.sent;if(!(response.status===200)){_context2.next=9;break;}user=response.data.user;token=response.data.token;// Set the token in client storage\nlocalStorage.setItem(\"token\",token);return _context2.abrupt(\"return\",user);case 9:_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);throw _context2.t0;case 14:case\"end\":return _context2.stop();}},_callee2,null,[[0,11]]);}));return function(_x2){return _ref2.apply(this,arguments);};}());// Create an async thunk for loginAnonymous\nexport var loginAnonymous=createAsyncThunk(\"user/loginAnonymous\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var response,isAuthenticated,user,token;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.post('https://closet-app-backend.fly.dev/api/loginAnonymous');case 3:response=_context3.sent;isAuthenticated=response.data.isAuthenticated;user=response.data.user;token=response.data.token;localStorage.setItem('token',token);return _context3.abrupt(\"return\",{isAuthenticated:isAuthenticated,user:user});case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](0);throw _context3.t0;case 14:case\"end\":return _context3.stop();}},_callee3,null,[[0,11]]);})));export var userSlice=createSlice({name:\"user\",initialState:initialState,reducers:{login:function login(state,action){state.user=action.payload;state.isAuthenticated=true;},logout:function logout(state){state.user=null;state.isAuthenticated=false;},setAuthentication:function setAuthentication(state,action){state.isAuthenticated=action.payload;},setUser:function setUser(state,action){state.user=action.payload;},clearAuthentication:function clearAuthentication(state){state.isAuthenticated=false;state.user=null;}},extraReducers:function extraReducers(builder){builder.addCase(loginUser.fulfilled,function(state,action){state.isAuthenticated=true;state.user=action.payload;}).addCase(loginUser.rejected,function(state,action){// Handle login failure if needed\n}).addCase(loginAnonymous.fulfilled,function(state,action){state.isAuthenticated=action.payload.isAuthenticated;state.user=action.payload.user;}).addCase(loginAnonymous.rejected,function(state,action){// Handle the error case here if needed\n});}});var _userSlice$actions=userSlice.actions,login=_userSlice$actions.login,logout=_userSlice$actions.logout;export{login,logout};export var selectUser=function selectUser(state){return state.user.user;};export var userIsAuthenticated=function userIsAuthenticated(state){return state.user.isAuthenticated;};export var userSliceReducer=userSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","initialState","user","isAuthenticated","registerUser","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","userData","response","wrap","_callee$","_context","prev","next","console","log","post","sent","status","abrupt","data","t0","stop","_x","apply","arguments","loginUser","_ref2","_callee2","token","_callee2$","_context2","localStorage","setItem","_x2","loginAnonymous","_callee3","_callee3$","_context3","userSlice","name","reducers","login","state","action","payload","logout","setAuthentication","setUser","clearAuthentication","extraReducers","builder","addCase","fulfilled","rejected","_userSlice$actions","actions","selectUser","userIsAuthenticated","userSliceReducer","reducer"],"sources":["/Users/kristo/kristos-closet/client/closet-app/src/features/userSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\nconst initialState = {\n    user: null,\n    isAuthenticated: false,\n};\n\n\n// Async thunk action to register user\nexport const registerUser = createAsyncThunk(\n    \"user/registerUser\",\n    async (userData) => {\n        try {\n        console.log(\"userData about to post\");\n        const response = await axios.post(\n            \"https://closet-app-backend.fly.dev/api/register\",\n            userData\n        );\n        console.log(\"userData posted\");\n\n        if (response.status === 201) {\n            return response.data;\n        }\n        } catch (error) {\n        throw error;\n        }\n    }\n);\n\n// Async thunk action to log in user\nexport const loginUser = createAsyncThunk(\n    \"user/loginUser\",\n    async (userData) => {\n      try {\n        const response = await axios.post(\n          \"https://closet-app-backend.fly.dev/api/login\",\n          userData\n        );\n  \n        if (response.status === 200) {\n          const user = response.data.user;\n          const token = response.data.token;\n  \n          // Set the token in client storage\n          localStorage.setItem(\"token\", token);\n  \n          return user;\n        }\n      } catch (error) {\n        throw error;\n      }\n    }\n);\n\n// Create an async thunk for loginAnonymous\nexport const loginAnonymous = createAsyncThunk(\n    \"user/loginAnonymous\",\n    async () => {\n      try {\n        const response = await axios.post('https://closet-app-backend.fly.dev/api/loginAnonymous');\n        const isAuthenticated = response.data.isAuthenticated;\n        const user = response.data.user;\n        const token = response.data.token;\n    \n        localStorage.setItem('token', token);\n    \n        return { isAuthenticated, user };\n      } catch (error) {\n        throw error;\n      }\n    }\n  );\n\nexport const userSlice = createSlice({\n    name: \"user\",\n    initialState,\n    reducers: {\n        login: (state, action) => {\n            state.user = action.payload;\n            state.isAuthenticated = true;\n        },\n        logout: (state) => {\n            state.user = null;\n            state.isAuthenticated = false;\n        },\n        setAuthentication: (state, action) => {\n            state.isAuthenticated = action.payload;\n          },\n        setUser: (state, action) => {\n            state.user = action.payload;\n        },\n        clearAuthentication: (state) => {\n            state.isAuthenticated = false;\n            state.user = null;        \n        },\n    },\n    extraReducers: (builder) => {\n        builder\n            .addCase(loginUser.fulfilled, (state, action) => {\n                state.isAuthenticated = true;\n                state.user = action.payload;\n            })\n            .addCase(loginUser.rejected, (state, action) => {\n                // Handle login failure if needed\n            })\n            .addCase(loginAnonymous.fulfilled, (state, action) => {\n                state.isAuthenticated = action.payload.isAuthenticated;\n                state.user = action.payload.user;\n            })\n            .addCase(loginAnonymous.rejected, (state, action) => {\n                // Handle the error case here if needed\n            });\n    },\n});\n\nexport const { login, logout } = userSlice.actions;\n\nexport const selectUser = (state) => state.user.user;\nexport const userIsAuthenticated = (state) => state.user.isAuthenticated;\n\nexport const userSliceReducer = userSlice.reducer;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}